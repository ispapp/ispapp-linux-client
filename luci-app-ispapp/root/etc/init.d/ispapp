#!/bin/sh /etc/rc.common

START=99
USE_PROCD=1

start_service() {
    procd_open_instance
    procd_set_param command /bin/ispappd start
    procd_set_param respawn ${respawn_threshold:-3600} ${respawn_timeout:-5} ${respawn_retry:-5}
    procd_set_param stdout 1
    procd_set_param stderr 1
    procd_set_param pidfile /var/run/ispappd.pid
    procd_set_param file /etc/config/ispappd
    procd_set_param limits nofile=65535
    procd_set_param user ispapp
    procd_set_param group ispapp
    procd_set_param env HOME=/var/run/ispappd
    procd_set_param env UCI_CONFIG=/etc/config/ispapp
    procd_close_instance
}

stop_service() {
    procd_close_instance
}

restart_service() {
    procd_close_instance
    start_service
}

reload_service() {
    procd_send_signal /var/run/ispappd.pid HUP
}

shutdown_service() {
    procd_send_signal /var/run/ispappd.pid TERM
}

enable_service() {
    uci set ispapp.@settings[0].enabled=1
    uci commit ispapp
}